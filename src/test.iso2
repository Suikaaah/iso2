iso clone = case x <-> (x, x) in
iso with_nil = case x <-> (x, []) in

iso rec len = case
  | [] <-> ([], 0)
  | x :: xs <->
      let (xs, n) = len xs in
      (x :: xs, S n)
in

iso rec rev = case
  | ([], l, 0) <-> ([], l, 0)
  | (x :: xs, l, S n) <->
      let (xs, l, n) = rev (xs, x :: l, n) in
      (xs, l, S n)
in

iso rev = case
  | l <->
      let (l, n) = len l in
      let ([], l, n) = rev (l, [], n) in
      let l = invert len (l, n) in
      l
in

let r = rev [1; 3; 4; 9] in

iso f = case x <-> let y = Some 3 :: [x] in y in

invert f [4; 5]
