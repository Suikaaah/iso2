type a = 0 | 1 | 2
type list = Nil | Cons of (a, list)

let iso id : a <-> a =
  | x <-> x
in

let iso dup : a <-> (a, a) =
  | x <-> let y = id x in (x, y)
in

let rec rev : (list, list) <-> (list, list) =
  | (Nil, l)         <-> (Nil, l)
  | (Cons (h, t), l) <->
      let c = Cons (h, l) in
      let l = rev (t, c) in
      l
in

let l = Cons (2, Cons (0, Cons (1, Cons (0, Nil)))) in

rev (l, Nil)
